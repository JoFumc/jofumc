<?php
/*
 * svc-process-book-sermon -- Service to process a 'sermon'
 *    book edit.
 *
 * NOTES:
 *   A 'sermon' is just a named instance of a generic story
 *   that has a series title and delivery date.
 */
/* Step 1: Get current user auth info */
require_once("library/core/util-db.php");
require_once("library/core/util-auth.php");
require_once("library/core/class-story.php");
require_once("library/core/util-skin.php");
auth_validate();

function get_field($field)
{
  if (!isset($_REQUEST[$field])) return null;
  if (null == $_REQUEST[$field]) return null;
  if (strlen($_REQUEST[$field]) < 1) return null;
  return $_REQUEST[$field];
}

print_r($_REQUEST);

/* Step 2: Create a story entry object from fields */
$st = new akStoryEntry();

$st->deliver_date = get_field('sermon-edit-date');
$st->series = get_field('sermon-edit-series');
$st->title = get_field('sermon-edit-title');
$st->book = get_field('sermon-edit-book');
$st->author = $auth_user->uid;

print_r($st);
/* Step 3: Create file to store text */
/* CLEAN: DO THIS */

/* Step 4: Push it into the DB */
db_saveStory($st);


?>
